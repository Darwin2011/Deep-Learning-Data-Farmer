DPM Administrator Guide:

How to get DPMSystem.sh.intel.com:8000 updated?

(8000 is formal on line port, only DPM Administrator could use it.
 Developers please use other port like 8888, 8005 etc for test.)

1.Enter DPM formal on line code directory

    cd /home/daiyan/zongrui/GPU-Test-Farmer-Online/GPU-Test-Farmer

    ps: It could be other path, but be aware that the file inside ./HPC_binaries is 
    not in git hub, so if you want to move GPU-Test-Farmer-Online, please copy
    the files inside ./HPC_binaries to the new folder as well.

2.Remove all changes in current version

    git reset --hard HEAD

3.Get latest code change

    git pull

4.Should use database automation, not database automation_test.

	vi task_scheduler.py

	-        self.sql_wrapper    = Mysql_wrapper('localhost', 'root', 'tracing', '
automations_test')

	+        self.sql_wrapper    = Mysql_wrapper('localhost', 'root', 'tracing', '
automations')

5.Check the change

	git diff

6. Make this server on line

	sudo nohup python server_start.py --port=8000

7. Check the final web site
	open chrome, type in "http://DPMSystem.sh.intel.com:8000" to see if the web
	page could be showed correctly.

Some notes about environment:
1.Enum version must be lower version 0.46, higher version will cause error: TypeError: issubclass() arg 1 must be a class
	pip install https://pypi.python.org/packages/source/e/enum/enum-0.4.6.tar.gz
2.Docker must be installed.


How to add a new docker image?
1.Supose you have get a new docker image file from Dai,Yan. (~ 4G)
2.Check current docker image
	docker images

3.Add this new docker image
	docker load -i image.tar

4.Check status again to see if image added successful.
	docker images

	for example:
	tracing@DPMSystem:/tmp$ docker images
REPOSITORY          TAG                                                 IMAGE
ID            CREATED             SIZE

nvidia/cuda         7.5-cudnn5-devel-ubuntu14.04-caffe-tensorflow-env
27030877f6fc        25 hours ago        4.758 GB

nvidia/cuda         7.5-cudnn5-devel-ubuntu14.04-caffe-env
b36f470d272b        9 weeks ago         3.012 GB


5.Add this docker image information into database
	!!!!this step is not need if you are just do deployment!!!!!
	INSERT INTO docker_images (REPOSITORY, TAG,\
             CUDA_VERSION, CUDA_VERSION_STRING, CUDNN_VERSION,\
             CUDNN_VERSION_STRING, TENSORFLOW, CAFFE) \
             VALUES("%s", "%s", %f, "%s", %f, "%s", %d, %d);



How to install Docker tools
1. wget -qO- https://get.docker.com/ | sh

2. sudo vi /etc/default/docker
	 http://child-prc.intel.com:913/

3. sudo service docker restart

   sudo docker run hello-world (for test)

4. sudo dpkg -i nvidia-docker.deb (needs to download this file)

5. sudo nvidia-docker version (for test)
		NVIDIA Docker: 1.0.0~rc.3


How to get DPMSystem deployed to another machine?
0. Check Linux system environment.
	It must have python/cuda 7.5/8.0 GFX
	device/ GFX driver installed on target machine.

1.Check docker environment using command "docker", if no --help output, need to install it.
	Please refer to "How to install Docker tools" part in this doc.

2.Install docker image.
	if do not have any docker image copied, please do

	scp /tmp/image.tar username@target_machine:/tmp/

	image.tar is located at DPMSystem.sh.intel.com.
	This image.tar is very large, needs hours to copy.


	For Installation, Please refer to "How to add a new docker image?"

3.Create a new folder
	make personal_dpm_test_version
	cd 	personal_dpm_test_version

4.Get code for git hub	git clone https://github.com/Darwin2011/GPU-Test-Farmer.git

5.Should use database automation, not database automation_test.

	vi task_scheduler.py

	-        self.sql_wrapper    = Mysql_wrapper('DPMSystem.sh.intel.com', 'root', 'tracing', '
automations_test')

	+        self.sql_wrapper    = Mysql_wrapper('DPMSystem.sh.intel.com', 'root', 'tracing', '
automations')

6.Check the change

	git diff

7.Make this server on line
	sudo nohup python server_start.py --port=8000

8.Check your hostname
	hostname

9.Check the final web site
	open chrome, type in "http://hostname.site.intel.com:8000" to see if the web
	page could be showed correctly.


